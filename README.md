# Cargo Tracker API Backend

This is the backend server for the MERN Cargo Shipment Tracker application. It provides API endpoints to manage shipment data stored in MongoDB.

## Features

*   List all shipments
*   Get details of a specific shipment
*   Create a new shipment
*   Update the current location of a shipment
*   Retrieve the estimated time of arrival (ETA) for a shipment

## Prerequisites

*   Node.js (v14 or later recommended)
*   npm or yarn
*   MongoDB (running locally or accessible via a connection string)

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <your-backend-repo-url> cargo-tracker-backend
    cd cargo-tracker-backend
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    # or
    # yarn install
    ```

3.  **Create Environment File:**
    Create a `.env` file in the root directory and add your environment variables:
    ```dotenv
    # MongoDB Connection String (replace with your actual URI)
    MONGODB_URI=mongodb://localhost:27017/cargo_tracker

    # Port for the server to run on
    PORT=5001
    ```

## Running the Application

*   **Development Mode (with automatic restarts):**
    ```bash
    npm run server
    ```
    The server will start, typically on `http://localhost:5001`.

*   **Production Mode:**
    ```bash
    npm start
    ```

## API Endpoints

*   `GET /api/shipments`: Retrieve all shipments.
*   `POST /api/shipments`: Create a new shipment.
    *   **Body (JSON):** `{ "containerId": "...", "origin": { "name": "...", "latitude": ..., "longitude": ... }, "destination": { "name": "...", "latitude": ..., "longitude": ... }, "route": [{ "name": "...", ... }], "status": "...", "notes": "..." }`
    *   `containerId`, `origin.name`, `destination.name` are required.
*   `GET /api/shipments/:id`: Retrieve a specific shipment by its MongoDB `_id` or `trackingId`.
*   `POST /api/shipments/:id/update-location`: Update the current location of a shipment (identified by `_id` or `trackingId`).
    *   **Body (JSON):** `{ "locationName": "...", "latitude": ..., "longitude": ... }` (`locationName` is required).
*   `GET /api/shipments/:id/eta`: Get the calculated ETA for a shipment (identified by `_id` or `trackingId`).

## Assumptions

*   **ETA Calculation:** The current ETA calculation (`calculateSimpleETA` method in `Shipment.js`) is **highly simplified** and assumes a fixed duration per leg of the route. For a production application, this would need replacement with a sophisticated calculation involving actual distances, average speeds, traffic data, and potentially external APIs.
*   **Location Coordinates:** The `LocationSchema` includes `latitude` and `longitude`. While the current API logic doesn't strictly require them for basic functionality, they are essential for map integration on the frontend. The frontend will need to handle providing these, potentially via geocoding user input if necessary.
*   **Tracking ID:** A simple tracking ID is generated by default. In a real system, a more robust and collision-resistant ID generation strategy would be used.
*   **Authentication/Authorization:** The API endpoints are currently public. In a real application, appropriate authentication and authorization mechanisms would be implemented.

## Future Enhancements and Improvements

This application provides a solid foundation for cargo shipment tracking. However, several features could be added to enhance its realism, efficiency, and usefulness in a production environment. Here are some potential areas for future development:

**1. Realistic Map Routing & ETA Calculation:**

*   **Enhancement:** Integrate with a real routing engine (e.g., OSRM, Mapbox, Google Maps Directions) to display actual road/sea routes instead of straight lines. Use the distance/duration data from the routing service, potentially combined with traffic or other factors, to calculate much more accurate ETAs.
*   **Benefit:** Provides visually accurate routes and significantly more reliable delivery predictions.
*   **Challenge:** Adds API integration complexity, potential API costs, and requires choosing between backend vs. frontend route calculation.

**2. Real-Time Updates & Automation:**

*   **Enhancement:** Replace manual location updates with real-time data streams from IoT GPS devices or Carrier APIs. Implement WebSockets for live frontend updates. Use Geofencing to automate status changes based on location.
*   **Benefit:** Provides up-to-the-minute tracking, reduces manual work, enables automated workflows.
*   **Challenge:** Significant integration effort with external systems/protocols, requires robust backend infrastructure, potential data costs.

**3. Authentication & Authorization:**

*   **Enhancement:** Implement user login/registration (e.g., using JWT) and role-based access control to secure shipment data and restrict actions based on user roles (admin, shipper, etc.).
*   **Benefit:** Essential security for protecting sensitive data in any real-world deployment.
*   **Challenge:** Adds significant development effort across the stack, requires careful security implementation.

**4. Advanced Data Handling & Display:**

*   **Enhancement:** Add advanced filtering (date ranges, location), sorting, and full-text search capabilities to the shipment list. Implement backend pagination to efficiently handle large numbers of shipments.
*   **Benefit:** Improves usability and performance, especially as the dataset grows.
*   **Challenge:** Requires backend API and database query optimization, adds frontend UI/state complexity.

**5. Richer Data Model & Event Logging:**

*   **Enhancement:** Expand the `Shipment` model with more details (cargo type, carrier, vessel). Add a detailed, timestamped `eventLog` array to track the history of each shipment. Potentially allow associating documents.
*   **Benefit:** Provides a more complete shipment record and a valuable audit trail.
*   **Challenge:** Increases schema/database complexity. Document handling adds file storage requirements.

**6. Geocoding:**

*   **Enhancement:** Allow users to enter addresses for origin/destination instead of coordinates, using a geocoding service to automatically find the latitude/longitude.
*   **Benefit:** Improves the user experience when creating shipments.
*   **Challenge:** Adds external API dependency and potential costs.

**7. Notifications:**

*   **Enhancement:** Implement automated in-app, email, or SMS notifications for key events like delays, arrivals, or delivery confirmations.
*   **Benefit:** Keeps users proactively informed.
*   **Challenge:** Requires backend logic for triggering notifications and integration with notification services (potential costs).

These enhancements represent potential directions for evolving the application into a more comprehensive and robust logistics tool. Contributions or further development could focus on these areas based on specific requirements.

## (Optional) Dockerization

Instructions for Docker would go here if implemented.